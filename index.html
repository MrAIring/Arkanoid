<!DOCTYPE html>
<html>
<head>
    <title>Ping-Pong!</title>
    <link rel="stylesheet" href="css/main.css"/>
    <script src="js/model.js"></script>
    <script src="js/view.js"></script>
    <script src="js/controller.js"></script>
    <script src="js/main.js"></script>
</head>
<body>
    <div class="field" id="field">
        <div id="here"></div>
        <div class="ball" id="ball"></div>
        <div class="desk" id="desk"></div>
    </div>

    <script>
        /*window.onload = addBlock();
            var desk = document.getElementById( 'desk' );
            var deskLeft = parseInt( window.getComputedStyle( desk ).left );
            var left = 0;
            var bricks = new Array(12);

        //---------------------------------------------------------------------
        //Bricks initialization and writing them to array
        function addBlock()
        {
            var bricks = new Array(12);
            var i = 0;
                for ( var row = 0; row < 3; row++ )
                {
                    for( var col = 0; col < 4; col++ )
                    {
                        var block = document.createElement( "div" );
                        var name = document.createTextNode( "i_am_block" );
                        block.appendChild( name );
                        block.className = 'blocks';
                        block.classList.add( 'block' + i );
                        block.style.left = col*267+ 'px';
                        block.style.top = row*50+ 'px';
                        bricks[i] = block;
                        var insert = document.getElementById( "here" );
                        insert.appendChild( block );
                        i++;
                    }
                }
        }

        //---------------------------------------------------------------------
        //Movement platform to the left side
        function moveDeskLeft()
        {
            if(deskLeft > 0)
            {
                deskLeft -= 5;
                desk.style.left = deskLeft + 'px';
            }
        }
        //---------------------------------------------------------------------
        //Movement platform to the right side
        function moveDeskRight()
        {
            if(deskLeft < 795)
            {
                deskLeft += 5;
                desk.style.left = deskLeft + 'px';
            }
        }
        //---------------------------------------------------------------------
        //Move the platform by pressing keys

        document.onkeydown = function(evt){
            switch (evt.keyCode)
            {
                case 37:
                    moveDeskLeft();
                    break;
                case 39:
                    moveDeskRight();
                    break;
            }
        };
        //---------------------------------------------------------------------
        //Ball movement

        var ball  = document.getElementById('ball');
        var field = document.getElementById('field');
        var platform = document.getElementById('desk');
        var d_x =  1.0;
        var d_y = -1.0;
        var h_ball  = parseFloat(window.getComputedStyle(ball).height);
        var w_ball  = parseFloat(window.getComputedStyle(ball).width);
        var h_field = parseFloat(window.getComputedStyle(field).height);
        var w_field = parseFloat(window.getComputedStyle(field).width);
        var w_platform = parseFloat(window.getComputedStyle(platform).width);
        var h_platform = parseFloat(window.getComputedStyle(platform).height);

        ball.style.left = '200px';
        ball.style.top  = '500px';

        function gameStep()
        {
            var posTop  = ball.offsetTop;
            var posLeft = ball.offsetLeft;
            var ballPositionX = parseFloat(window.getComputedStyle(ball). left) ;
            var ballPositionY = parseFloat(window.getComputedStyle(ball). top);

            if ( ballPositionX <= 0 )                 { d_x =  1.0;  }
            if ( ballPositionX >= w_field - w_ball )  { d_x = -1.0;  }
            if ( ballPositionY <= 0 )                 { d_y =  1.0;  }
            if ( ballPositionY >= h_field - h_ball )  { d_y = -1.0;  }

            ball.style.top  = (posTop  + d_y) + 'px';
            ball.style.left = (posLeft + d_x) + 'px';
        }

        setInterval( gameStep, 10);

        function bricksCrd(){
            for(var it = 0; it < 12; it++)
            {
                var x1 = bricks[it].style.left;
            }
        }


        //---------------------------------------------------------------------
        function isCollision (x1,y1,x2,y2,x3,y3,x4,y4,ballX,ballY){

            var ballRAD = ball.style.width / 2;
            ballX   = ball.style.left + ballRAD;
            ballY   = ball.style.top  + ballRAD;

            //left bottom point

            x1 = x1.style.top + x1.style.height ;
            y1 = y1.style.left;

            //left top point

            x2 = x2.style.left;
            y2 = y2.style.top;

            //right top point

            x3 = x3.style.left + x3.style.width;
            y3 = y3.style.top;

            //right bottom point

            x4 = x4.style.top + x4.style.height;
            y4 = y4.style.left + y4.style.width;
        }*/

        //---------------------------------------------------------------------
        //Coordinates initialization and checking cycle


       /* if (ball.getBoundingClientRect){                                                            //ball coordinates init
            var ballRect = {
                rect: ball.getBoundingClientRect(),
                x   : ball.style.left,
                y   : ball.style.top,
                w   : ball.style.right,
                h   : ball.style.bottom
            }
        }

        var platformRect = {
            rect: platform.getBoundingClientRect(),                                                 //platform coordinates init
            x   : platform.style.left,
            y   : platform.style.top,
            w   : platform.style.right,
            h   : platform.style.bottom
        };

        var ballRectArr = [ballRect.x, ballRect.h, ballRect.w, ballRect.y];                         //ball coordinates into array
        var platformRectArr = [platformRect.x, platformRect.h, platformRect.w, platformRect.y];     //platform coordinates into array

        var onCollisionWithPlatform = false;

        for( var i = 0; i<4 ; i++ )
        {
            if( isPointInside(platformRect, ballRect[i]) == true )                                  //checking collision depending on function
                                                                                                    //isPointInside
            {
                onCollisionWithPlatform = true;
            }
        }
        if ( onCollisionWithPlatform == true)
        {
            d_x = -d_x;                                                                             //change direction
        }
        //---------------------------------------------------------------------
        //Checking function "isPointInside"
        function isPointInside(*//**//*)
        {
            if( polygon.size() <=1 )
            return false;

            var intersections_num = 0;
            var prev = polygon[prev].y < point.y;

            for (var i = 0; i < polygon.size(); ++i)
            {
                var cur_under = polygon[i].y < point.y;
                Point2f a:
            }
        }*/
    </script>
</body>
</html>